***Article Views
select distinct
 author_id  as id
 from
 views
where author_id=viewer_id
order by id;

***Invalid Tweets
select
tweet_id
from
Tweets
where length (content) > 15;
***Replace Employee ID With The Unique Identifier
select 
eu.unique_id,
e.name
from employees e
left join EmployeeUNI eu on e.id=eu.id;
### Product Sales Analysis I
# Write your MySQL query statement below
select 
p.product_name,
s.year,
s.price
from
sales s
left join product p on s.product_id=p.product_id;
###Customer Who Visited but Did Not Make Any Transactions
select
v.customer_id,
count(v.visit_id) as count_no_trans
from visits v
 left join transactions t on v.visit_id= t.visit_id
where t.transaction_id is null
group by v.customer_id;

***. Rising Temperature
select w1.id as id
from Weather w1
join weather w2 on  w1.recordDate= w2.recordDate + interval 1 day
where w1.temperature>w2.temperature;

***. Average Time of Process per Machine
SELECT machine_id,
   ROUND(AVG(processing_time), 3) AS processing_time
FROM (
    SELECT machine_id,
     MAX(CASE WHEN activity_type = 'end' THEN timestamp END) -
     MIN(CASE WHEN activity_type = 'start' THEN timestamp END) AS processing_time
    FROM Activity
    GROUP BY machine_id, process_id
) AS process_durations
GROUP BY machine_id;
***Employee Bonus
select
    e.name,
    b.bonus
from Employee e
left join bonus b on e.empId=b.empId
where b.bonus < 1000 or b.bonus is null;

***Students and Examinations
# Write your MySQL query statement below
SELECT 
    s.student_id, 
    s.student_name, 
    sb.subject_name, 
    COUNT(e.subject_name) AS attended_exams
FROM Students s
JOIN Subjects sb
LEFT JOIN Examinations e ON s.student_id = e.student_id AND sb.subject_name = e.subject_name
GROUP BY s.student_id, sb.subject_name
ORDER BY s.student_id, sb.subject_name;


***Confirmation Rate
select
   s.user_id,
    round( avg((case when c.action ="confirmed" then 1 else 0 end)),2) as confirmation_rate
   from Signups s
  left join Confirmations c on s.user_id=c.user_id
   group by user_id;

***Managers with at Least 5 Direct Reports
select
e1.name
from
Employee e1
Inner join Employee e2
on e1.id=e2.managerID
group by e2.managerID
having count(e2.managerID)>=5;

